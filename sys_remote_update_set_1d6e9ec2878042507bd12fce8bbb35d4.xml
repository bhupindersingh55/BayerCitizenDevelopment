<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2024-01-31 21:07:35">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>Bay - TL - Deployment Pipeline  Suite Config V2</name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value=""/>
<remote_parent_id/>
<remote_sys_id>f5c6165f1b1f219019647449cd4bcb7a</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>1d6e9ec2878042507bd12fce8bbb35d4</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_00f8e03287ae1150fc79edbe8bbb35b8</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;user_experience&lt;/category&gt;&lt;description&gt;The GlideAjax (Asynchronous) does not work on onSubmit Client Script. This is because of the fundamental behavior of Asynchronous scripts which are non-blocking by nature.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sys_kb_id=752ed2fddbfc0490d58ea345ca96196e&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Asynchronous AJAX call in on-submit client scripts&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Modify the client script as per the following documentation.
1) https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sys_kb_id=752ed2fddbfc0490d58ea345ca96196e
2) https://community.servicenow.com/community?id=community_blog&amp;amp;sys_id=dc49feeadbdd7f0c54250b55ca96191d&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(finding) {

    var updateVersionAPI = new global.UpdateVersionAPI(); // updateVersionAPI to find custom sys_metadata records
    var clientScripts = new GlideRecord('sys_script_client');
    clientScripts.addQuery('sys_class_name', 'sys_script_client');
    clientScripts.addActiveQuery();
    // get all active on-submit custom client scripts with getXML/getXMLAnswer in it.
    clientScripts.addEncodedQuery("scriptLIKEgetXML(^ORscriptLIKEgetXMLAnswer^type=onSubmit^scriptNOT LIKEgetActionName");
    clientScripts.query();
    var resClientScripts = updateVersionAPI.getCustomerFileIds(clientScripts); // Find the custom clientscripts with getXML/getXMLAnswer
    if (resClientScripts.length &gt; 0) { //If there are custom client scripts using getXML/getXMLAnswer
        for (var i = 0; i &lt; resClientScripts.length; i++) {
            var csGr = new GlideRecord('sys_script_client');
            // Get the specific client script and create finding records.
            if(csGr.get(resClientScripts[i])){
                finding.setCurrentSource(csGr);
                finding.increment();
            }
        }
    }

})(finding);]]&gt;&lt;/script&gt;&lt;short_description&gt;Asynchronous AJAX call in on submit client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;00f8e03287ae1150fc79edbe8bbb35b8&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Asynchronous AJAX call in on-submit client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_00f8e03287ae1150fc79edbe8bbb35b8&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>33134784</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>116e9ec2878042507bd12fce8bbb35d5</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac1fd0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Asynchronous AJAX call in on-submit client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>f94c2c76deae1150f56f84ed131630c3</update_guid>
<update_guid_history>f94c2c76deae1150f56f84ed131630c3:33134784,c0f8e032e2ae1150a70b499bd231bab9:1219366324</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_27e8e03287ae1150fc79edbe8bbb3524</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Always create reference fields if the foundational data already exists like users, locations, companies. Refer the attached chart listing foundational tables in ServiceNow.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/en-US/bundle/sandiego-platform-administration/page/administer/reference-pages/reference/r_FieldTypes.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Utilize reference fields for foundational data&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Below are the foundational tables in ServiceNow-

Label                                Name                              Description

User                                  sys_user                         List of all ServiceNow instance users. 
Location                         cmn_location               List of all user locations. Users are typically  associated with a location. 
Group                              sys_user_group           List of all the groups. Users are typically associated  with groups and inherit any security roles  associated with those groups. 
Company                       core_company             List of companies that interact with your organization. 
Role                                  sys_yser_role               List of security roles in the instance. Some will be default roles; others will be created by your organization.   
Task                                  task                                   The common base table that gets extended. It has  fields and functionality related to assigning work across teams and individuals, managing the state  or the cask, and other functions.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Utilize reference fields for foundational data&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;27e8e03287ae1150fc79edbe8bbb3524&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Utilize reference fields for foundational data&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_27e8e03287ae1150fc79edbe8bbb3524&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1676595421</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>116e9ec2878042507bd12fce8bbb35d6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac23e0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Utilize reference fields for foundational data</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>b14c2c76f3ae1150f37d0696e54e0fe3</update_guid>
<update_guid_history>b14c2c76f3ae1150f37d0696e54e0fe3:-1676595421,e7e8e03283ae11508288255024bd1a25:-232845137</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_6fe8e03287ae1150fc79edbe8bbb350a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;It is a best practice to use UI policy to make a field mandatory, read-only, visible etc. instead of using a client script.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/en-US/bundle/sandiego-platform-administration/page/administer/form-administration/task/t_CreateAUIPolicy.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Use UI Policies instead of g_form API&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;It is a best practice to use UI policy to make a field mandatory, read-only, visible etc. instead of using a client script.

Create new UI policies to replace or update the client scripts that involves the following methods as part of API call-

setMandatory
setVisible
setDisplay
setReadOnly

Alternatively, if the fields needs to be displayed or hidden based on certain roles than create security rules.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    engine.rootNode.visit(function(node) {
        if (node.getNameIdentifier() &amp;&amp;
            node.getTypeName() === 'NAME' &amp;&amp;
            node.getParent().getTypeName() === 'GETPROP' &amp;&amp;
            (node.getNameIdentifier() === 'setMandatory' || node.getNameIdentifier() === 'setVisible' || node.getNameIdentifier() === 'setDisplay' || node.getNameIdentifier() === 'setReadOnly')) {
            engine.finding.incrementWithNode(node);
        }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Use UI Policies instead of g_form API&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;6fe8e03287ae1150fc79edbe8bbb350a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Use UI Policies instead of g_form API&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_6fe8e03287ae1150fc79edbe8bbb350a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-29337145</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>116e9ec2878042507bd12fce8bbb35d9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3240000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Use UI Policies instead of g_form API</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>4a4c6c7656ae11506a06f8515970a13a</update_guid>
<update_guid_history>4a4c6c7656ae11506a06f8515970a13a:-29337145,23e8e03270ae11508cac9a4cf47e4b0c:2126504787</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_63e8e03287ae1150fc79edbe8bbb3514</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Number of fields displayed in list layout i.e. when viewing the form/table data in list view then number of fields in the view should not exceed 8 as this may impact the instance performance.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/sandiego-platform-administration/page/administer/list-administration/task/t_ConfigureTheListLayout.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Limit the fields displayed in list layout&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Number of fields displayed in list layout i.e. when viewing the form/table data in list view then number of fields in the view should not exceed 8 as this may impact the instance performance.

Follow the below steps to fix-

1. Navigate to AES
2. Click on Data and locate the table for which list layout needs to be updated
3. Open the table and click on "Preview" button. This opens the list layout.
4. Right click on the list header. Select Configure &amp;gt; List Layout. This opens the sluchbucket page.
5. Move some of the fields from "Selected" box to "Available" box.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Declare variables
 var tableID = engine.current.getValue("sys_id");
 
 // Count number of fields in the list view
 var aggListElements = new GlideAggregate('sys_ui_list_element');
 aggListElements.addQuery('list_id',tableID);
 aggListElements.addAggregate('COUNT');
 aggListElements.query();
 if(aggListElements.next()) {
  if(aggListElements.getAggregate('COUNT') &gt; 8) {
   engine.finding.increment();
  }
 }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Limit the fields displayed in list layout to 8&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;63e8e03287ae1150fc79edbe8bbb3514&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Limit the fields displayed in list layout&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_63e8e03287ae1150fc79edbe8bbb3514&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-879004567</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>156e9ec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2f70000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Limit the fields displayed in list layout</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>4e4c6c76cfae1150503b257c3e660f27</update_guid>
<update_guid_history>4e4c6c76cfae1150503b257c3e660f27:-879004567,27e8e0325dae115061a8012b4dfe3315:1295753205</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_37e8e03287ae1150fc79edbe8bbb359c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;getXMLAnswer only retrieves the Answer which we are actually after. getXML retrieves the whole XML document. In most cases, we are not interested in the whole XML document, though only in the Answer.
For the rare cases where you are interested in the whole XML document, simply mute the generated scan finding.&lt;/description&gt;&lt;documentation_url&gt;https://community.servicenow.com/community?id=community_article&amp;amp;sys_id=1c10a1fedbbd4890feb1a851ca961909&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Consider using getXMLAnswer instead of getXML&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Replace the usage of getXML by getXMLAnswer.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

 // Perform Linter Check
 engine.rootNode.visit(function(node) {
  if(node.getTypeName() === "NAME" &amp;&amp;
     node.getNameIdentifier() === "getXML" &amp;&amp;
     node.getParent().getTypeName() === "GETPROP") {
   // Create scan finding
   engine.finding.incrementWithNode(node);
  }
 });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Consider using getXMLAnswer instead of getXML&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;37e8e03287ae1150fc79edbe8bbb359c&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Consider using getXMLAnswer instead of getXML&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_37e8e03287ae1150fc79edbe8bbb359c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-2044262493</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>196e9ec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2c50000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Consider using getXMLAnswer instead of getXML</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>8a4c6c7636ae1150f86db55ed5e76908</update_guid>
<update_guid_history>8a4c6c7636ae1150f86db55ed5e76908:-2044262493,f7e8e032e0ae115043d76ce4d1394c9d:1252935471</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_80f8e03287ae1150fc79edbe8bbb35aa</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;upgradability&lt;/category&gt;&lt;description&gt;Extending the sys_user table is NOT recommended because it can cause problems when a user needs to be present in both tables. Remember that the User ID [sys_user.user_name] is a unique field.

If you have:
sys_user
contract_user extends sys_user
subsidiary_user extends sys_user
Then you create Bob who is a contract_user
Bob's class will never be sys_user.
Bob can never be a subsidiary_user.
To make Bob both a contract_user and a subsidiary_user, Bob must have 2 accounts.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;User table should not be extended&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Reevaluate the requirements behind this and remove the extended tables:
- Different process-related requirements should be tackled by standardizing processes at an organizational level.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;User table should not be extended&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;80f8e03287ae1150fc79edbe8bbb35aa&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;User table should not be extended&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_80f8e03287ae1150fc79edbe8bbb35aa&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1613548378</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>196e9ec2878042507bd12fce8bbb35da</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3a20000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>User table should not be extended</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>524c6c7673ae1150d3e03ede33bc8d60</update_guid>
<update_guid_history>524c6c7673ae1150d3e03ede33bc8d60:-1613548378,44f8e03293ae11507e1d7be52f0b8fab:-1550846414</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_2fe8e03287ae1150fc79edbe8bbb3541</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;UI Actions using GlideRecord's getRowCount property may cause performance issues when working on tables with a high record count.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/reference/api/quebec/server_legacy/c_GlideAggregateAPI?navFilter=GlideAggregate&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;UI Buttons using getRowCount may cause performance issues&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Instead of GlideRecord API,  use GlideAggregate to improve performance. Refer the following document on how to COUNT the records using GlideAggregate
--------------------------------------------------------------------------------
| Sample script to count number of records in incident table. | 
--------------------------------------------------------------------------------
var aggIncident = new GlideAggregate('incident');
var incidentCount ;
aggIncident.addAggregate('COUNT');
aggIncident.query();
while(aggIncident.next()){
           incidentCount = aggIncident.getAggregate('COUNT')
}
gs.print(incidentCount)&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;UI Actions using getRowCount may cause performance issues&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;2fe8e03287ae1150fc79edbe8bbb3541&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;UI Buttons using getRowCount may cause performance issues&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_2fe8e03287ae1150fc79edbe8bbb3541&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>722193561</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>1d6e9ec2878042507bd12fce8bbb35d6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2830000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>UI Buttons using getRowCount may cause performance issues</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>8e4c2c7634ae1150ac7c3735a86d23f5</update_guid>
<update_guid_history>8e4c2c7634ae1150ac7c3735a86d23f5:722193561,efe8e0322bae1150f933a33942c3aa42:1338058125</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_7be8e03287ae1150fc79edbe8bbb3556</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;ACLs without roles or condition or scripts may allow unintended users to update/delete/create/read records.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/quebec-platform-administration/page/administer/contextual-security/concept/access-control-rules.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;ACLs without roles or condition or scripts&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Review ACL and do one of the following:
a) Add required roles or condition or scripts to the ACLs
b) Disable and validate if ACL is not needed, if after 7 days no issues, take XML backup and delete.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (finding) {
 var updateVersionAPI = new global.UpdateVersionAPI(); // updateVersionAPI to find custom sys_metadata records
 var aclsGr = new GlideRecord('sys_security_acl');
  aclsGr.addEncodedQuery('active=true^type=record^conditionISEMPTY^scriptISEMPTY');
  aclsGr.query();
 var customACLs = updateVersionAPI.getCustomerFileIds(aclsGr); // Find the ACLs without condition/script.
 if(customACLs.length &gt; 0){ //custom ACLs without condition/script??
  for (var i = 0; i &lt; customACLs.length; i++){
   var aclsRoleGr = new GlideRecord('sys_security_acl_role'); //Check if the ACL has a role defined.
   aclsRoleGr.addQuery('sys_security_acl',customACLs[i]);
   aclsRoleGr.setLimit(1);
         aclsRoleGr.query();
   if(!aclsRoleGr.next()){ // If the ACL has no role, get the specific ACL GlideRecord and create finding
    var fACLGr = new GlideRecord('sys_security_acl');
    fACLGr.get(customACLs[i]);
    finding.setCurrentSource(fACLGr); 
    finding.increment();
   } 
  }
 } 
})(finding);]]&gt;&lt;/script&gt;&lt;short_description&gt;ACLs without roles or condition or scripts may cause unintended results&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;7be8e03287ae1150fc79edbe8bbb3556&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;ACLs without roles or condition or scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_7be8e03287ae1150fc79edbe8bbb3556&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-135951008</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>1d6e9ec2878042507bd12fce8bbb35d9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3730000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>ACLs without roles or condition or scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>464c6c764fae1150e60ee32cb7eb1d4d</update_guid>
<update_guid_history>464c6c764fae1150e60ee32cb7eb1d4d:-135951008,3fe8e0324dae1150fef6b9f8604b1d57:44046932</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_abe8e03287ae1150fc79edbe8bbb351f</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Every field is labeled "sentence case" i.e.  which capitalises only the first letter of each sentence (i.e. Risk assessment, Assignment group and Status reason). This is an out-of-box convention within Service-now.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Fields label to be in sentence case&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Every field is labeled "sentence case" i.e.  which capitalises only the first letter of each sentence (i.e. Risk assessment, Assignment group and Status reason). This is an out-of-box convention within Service-now.

1. Navigate to Table Builder in AES
2. Locate the field to be updated
3. Correct the column label reflecting sentence case&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    // Define variables
    var regExpUpper = /^[A-Z]/;
    var regExpLower = /^[a-z]/;
    var regExpAllUpperCaseChar = /^[^a-z]*$/;
    var regExpAllLowerCaseChar = /^[^A-Z]*$/;
    var fieldLabel = engine.current.column_label.toString();

    // Check field label without sentence case
    fieldLabel = fieldLabel.split(' ');
    for (var i = 0; i &lt; fieldLabel.length; i++) {
        if (i == 0) {
            if ((!regExpUpper.test(fieldLabel[i])) || regExpAllUpperCaseChar.test(fieldLabel[i]) || regExpAllLowerCaseChar.test(fieldLabel[i])) {
                engine.finding.increment();
                break;
            }
        } else if (!regExpLower.test(fieldLabel[i]) || regExpAllUpperCaseChar.test(fieldLabel[i])) {
            engine.finding.increment();
            break;
        }
    }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Fields label to be in sentence case&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;abe8e03287ae1150fc79edbe8bbb351f&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Fields label to be in sentence case&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_abe8e03287ae1150fc79edbe8bbb351f&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>616168988</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>216e9ec2878042507bd12fce8bbb35dc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4160000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Fields label to be in sentence case</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>d24c6c76e1ae11505466d9ff8dd6d9d0</update_guid>
<update_guid_history>d24c6c76e1ae11505466d9ff8dd6d9d0:616168988,6fe8e032b8ae11509db6ba7b07015a20:132133136</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_a7e8a03287ae1150fc79edbe8bbb35e6</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Club all the onSubmit() client scripts into one, otherwise, it leads to ambiguity when form is submited and user may get confused with background details.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Merge onSubmit() client scripts&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Club all the onSubmit() client scripts into one, otherwise, it leads to ambiguity when form is submited and user may get confused with background details.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    // Declare the variables
    var tableName = engine.current.getValue('table');

    // Count number of active onLoad client scripts for application table
    var aggScripts = new GlideAggregate('sys_script_client');
    aggScripts.addQuery('type', 'onSubmit');
    aggScripts.addQuery('table', tableName);
    aggScripts.addActiveQuery();
    aggScripts.addAggregate('COUNT', 'table');
    aggScripts.query();
    if (aggScripts.next()) {
        var scriptCount = aggScripts.getAggregate('COUNT', 'table');
        if (scriptCount &gt; 1) {
            engine.finding.setCurrentSource(tableName);
            engine.finding.increment();
        }
    }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Merge onSubmit() client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;a7e8a03287ae1150fc79edbe8bbb35e6&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Merge onSubmit() client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_a7e8a03287ae1150fc79edbe8bbb35e6&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-123724249</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>256e9ec2878042507bd12fce8bbb35db</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3d90000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Merge onSubmit() client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>5e4c6c76adae115070220f34c4c99272</update_guid>
<update_guid_history>5e4c6c76adae115070220f34c4c99272:-123724249,6be8a032c4ae1150474053edbcd65ae7:652307891</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_e3e8e03287ae1150fc79edbe8bbb3506</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;The g_form.getReference() method requests the whole Record (that's right, the whole record, one big Object with all fields values) to the server. It may cause slowness to your Client Side action.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/en-US/bundle/sandiego-application-development/page/script/ajax/topic/p_AJAX.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Avoid g_form.getReference() in client scripts&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;The g_form.getReference() method requests the whole Record ( one big Object with all fields values) to the server. It may cause slowness to your Client Side action.

Best way to call from Server data is using GlideAjax API. Sometimes calling API REST can be a good way to acomplish this task as well.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    engine.rootNode.visit(function(node) {
        if (node.getNameIdentifier() &amp;&amp;
            node.getTypeName() === 'NAME' &amp;&amp;
            node.getParent().getTypeName() === 'GETPROP' &amp;&amp;
            node.getParent().getParent().getTypeName() === 'CALL' &amp;&amp;
            (node.getNameIdentifier() === 'getReference')) {
            node.getParent().visit(function(childnode) {
                if (childnode.getNameIdentifier() &amp;&amp;
                    childnode.getTypeName() === 'NAME' &amp;&amp;
                    childnode.getNameIdentifier() === 'g_form') {
                    engine.finding.incrementWithNode(node);
                }
            });
        }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Avoid g_form.getReference() in client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;e3e8e03287ae1150fc79edbe8bbb3506&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Avoid g_form.getReference() in client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_e3e8e03287ae1150fc79edbe8bbb3506&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-610272955</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>256e9ec2878042507bd12fce8bbb35de</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4a30000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Avoid g_form.getReference() in client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>e24cac7629ae1150759e0aead1fe693a</update_guid>
<update_guid_history>e24cac7629ae1150759e0aead1fe693a:-610272955,a7e8e0321fae1150d90f52ef8f020707:529816889</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_bfe8e03287ae1150fc79edbe8bbb3570</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;In a "before" Business Rule, an update of the current record should not be necessary as the record will be saved upon completion of the highest ordered Business Rule.  Furthermore, in certain cases, the save may need to be stopped in the chain of Before business rules (with use of the setAbortAction function), and if the record has already been updated, data may have already been saved which would normally be an invalid save by the logic of the Business Rule.

In an "after" Business Rule current.update() should also not be used.  Any action that might be performed in an After Business Rule can usually have been added in a high ordered Before Business Rule, eliminating any need for an explicit update() function call.  In addition, updating in an After Business Rule will cause all Before Business Rules to run again, which, as mentioned previously could cause performance processing issues.

For more information, go through the support documentation URL provided 

https://docs.servicenow.com/bundle/rome-application-development/page/script/business-rules/reference/r_HowBusinessRulesWork.html#d2794255e260
https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0722983&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0715782&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Business rules should not use current.update()&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Remove unnecessary current.update() from a business rule. In case you need to update data on the current record, move the logic to a before business rule without using current.update()

In certain exception cases, if you need to use current.update() eg in onAfter scripts, use it along with the setWorkflow() so it dont remain in an infinte loop.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Business rules should not use current.update()&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;bfe8e03287ae1150fc79edbe8bbb3570&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Business rules should not use current.update()&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_bfe8e03287ae1150fc79edbe8bbb3570&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-260056697</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>296e9ec2878042507bd12fce8bbb35dd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4780000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Business rules should not use current.update()</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>124cac7678ae1150e697f885b6454c1b</update_guid>
<update_guid_history>124cac7678ae1150e697f885b6454c1b:-260056697,73e8e032e3ae11505e83b14ce11ebe72:-494619013</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_fbe8e03287ae1150fc79edbe8bbb3590</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;In general, for a single record only a few Workflow context will be running. If a high number of Workflow context are active, this often indicates an issue on the starting conditions of your Workflow. More then 10 active Workflow context is considered being a high number.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;High number of workflows running for a single record&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Resolve the high number of triggered Workflow context and investigate the starting conditions of your Workflow and correct where necessary.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (finding) {

 // Count record
 var countRecord = new GlideAggregate('wf_context');
 countRecord.addEncodedQuery('state=executing');
 countRecord.groupBy('id');
 countRecord.addAggregate('COUNT');
 countRecord._query();

 while(countRecord._next()) {
  if(countRecord.getAggregate('COUNT') &gt; 10) {
   // Get record
   var getRecord = new GlideRecord('wf_context');
   getRecord.addQuery('id', countRecord.id);
   getRecord.setLimit(1);
   getRecord._query();

   if(getRecord._next()) {
    // Create scan finding
    var createFinding = new GlideRecord(getRecord.getValue('table'));

    if(createFinding.get(getRecord.getValue('id'))) {
     finding.setCurrentSource(createFinding);
     finding.increment();
    }
   }
  }
 }

})(finding);]]&gt;&lt;/script&gt;&lt;short_description&gt;High number of workflows running for a single record&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;fbe8e03287ae1150fc79edbe8bbb3590&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;High number of workflows running for a single record&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_fbe8e03287ae1150fc79edbe8bbb3590&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1226611159</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>296edec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac5160000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>High number of workflows running for a single record</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>224cac762eae1150d879be3e4690a485</update_guid>
<update_guid_history>224cac762eae1150d879be3e4690a485:-1226611159,bfe8e032d7ae1150e904bc491e8cd391:-1782443747</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_bbe8e03287ae1150fc79edbe8bbb354f</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;When a flow errors while executing, the flow aborts abruptly for further execution. This could lead to unexpected automation issues.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Errored Flow engine context&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Investigate why the flow ran into an error.&lt;/resolution_details&gt;&lt;run_condition&gt;var gr = new GlideRecord('sys_flow_context');gr.setLimit(1);gr.query();gr.hasNext();&lt;/run_condition&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Errored Flow engine context&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;bbe8e03287ae1150fc79edbe8bbb354f&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Errored Flow engine context&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_bbe8e03287ae1150fc79edbe8bbb354f&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1905501696</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>2d6e9ec2878042507bd12fce8bbb35dc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4420000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Errored Flow engine context</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>964c6c76f5ae1150e69f220541cf90ef</update_guid>
<update_guid_history>964c6c76f5ae1150e69f220541cf90ef:1905501696,7fe8e03281ae1150aa18d40c22fdea50:1210967436</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_ebe8e03287ae1150fc79edbe8bbb3518</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Application created via App Engine Studio cannot contain more than 3 characters as table "Prefix". In addition to this, "Number of digits" should not be more than 7&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/rome-platform-administration/page/administer/field-administration/concept/c_ManagingRecordNumbering.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Table prefix and number of digits&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;1. Open the Table in App Engine Studio via Table Builder
2. Click on the "Properties" button displayed on the right side of the screen in Table Builder. This should open table properties.
3.  Click on "Advance". This should show the "Prefix" and "Number of digits".
4. Changing the Prefix and Number of digits may not have much impact if application has yet not been deplyed to the production instance.
5. If application already exists in Prod, then "Changing field &amp;lt;&amp;lt;Number of digits&amp;gt;&amp;gt; may update all number values for existing records on a table. Take care when changing this field on a production instance."&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    var grNum = new GlideRecord('sys_number');
    grNum.addQuery('category.sys_id', engine.current.sys_id);
    grNum.query();
    if (grNum.next()) {
        if (grNum.getValue('prefix').length &gt; 3 || grNum.getValue('maximum_digits') &gt; 7) {
            engine.finding.increment();
        }
    }


})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Standardize table prefix and number of digits limit - Global.&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;ebe8e03287ae1150fc79edbe8bbb3518&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Table prefix and number of digits&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_ebe8e03287ae1150fc79edbe8bbb3518&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>380701555</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>2d6edec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4dc0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Table prefix and number of digits</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>264cac764bae11504ebb100e46bea772</update_guid>
<update_guid_history>264cac764bae11504ebb100e46bea772:380701555,afe8e032e0ae115091587076b8ed5d19:1967171431</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_63e8a03287ae1150fc79edbe8bbb35e4</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;A global client script is any client script where the selected Table is Global. Global client scripts have no table restrictions, therefore they will load on every page in the system introducing browser load delay in the process.

There is no benefit to loading this kind of scripts on every page.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/sandiego-application-development/page/script/client-scripts/concept/client-script-best-practices.html#r_AvoidGlobalClientScripts&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Avoid global client scripts&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;A global client script is any client script where the selected Table is Global. Global client scripts have no table restrictions, therefore they will load on every page in the system introducing browser load delay in the process.

There is no benefit to loading this kind of scripts on every page.

As an alternative, and for a more modular and scalable approach, consider moving client scripts to a base table (such as Task[task] or Configuration Item[cmdb_ci]) that can be derived for all the child/extending tables. This eliminates the system loading the scripts on every form in the UI - such as home pages or Service Catalog where they are rarely (if ever) needed.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Avoid global client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;63e8a03287ae1150fc79edbe8bbb35e4&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Avoid global client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_63e8a03287ae1150fc79edbe8bbb35e4&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-658081429</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>516e9ec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2ea0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Avoid global client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>824c6c76a1ae1150ee813152cb20a723</update_guid>
<update_guid_history>824c6c76a1ae1150ee813152cb20a723:-658081429,27e8a03230ae11500312080d4be5f2e5:-1810998025</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_37e8e03287ae1150fc79edbe8bbb356c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;The value of a reference field is a sys_id. When you dot-walk to the sys_id, the system does an additional database query to retrieve the caller_id record, then retrieves the sys_id. This can lead to performance issues.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/guides/rome/now-platform/tpb-guide/scripting_technical_best_practices#avoid-dot-walking-to-the-sys-id-of-a-reference-field&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Avoid Dot-Walking to the sys_id of a Reference Field&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Instead of 
var id = current.caller_id.sys_id;

use 
var id = current.getValue('caller_id');&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    engine.rootNode.visit(function(node) {
  if (node.getNameIdentifier() &amp;&amp; node.getNameIdentifier() === 'sys_id' 
   &amp;&amp; node.getParent().getTypeName() === 'GETPROP') {

   // Found dot-walk to sys_id. Check for sibling nodes
   var numChildren = 0;
   node.getParent().visit(function(childnode) {
    if (childnode.getTypeName() === "GETPROP") {
     numChildren++;
    }
   });
   // Ignore parent nodes with only one child where sys_id is the child
   // eg. current.sys_id
   // Assume all other parents with multiple children are dot-walks to sys_id
   // of a reference field eg. current.caller_id.sys_id
   // Where children = [current.caller_id, current.caller_id.sys_id]
   if (numChildren &gt; 1)
    engine.finding.incrementWithNode(node);
  }
 });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Avoid Dot-Walking to the sys_id of a Reference Field&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;37e8e03287ae1150fc79edbe8bbb356c&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Avoid Dot-Walking to the sys_id of a Reference Field&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_37e8e03287ae1150fc79edbe8bbb356c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1695596497</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>556e9ec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2b80000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Avoid Dot-Walking to the sys_id of a Reference Field</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>ce4c6c767dae1150fa18df35b9d52503</update_guid>
<update_guid_history>ce4c6c767dae1150fa18df35b9d52503:1695596497,f7e8e032a2ae1150fb9e390b2f64956d:1092907461</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_7fe8e03287ae1150fc79edbe8bbb35a7</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;upgradability&lt;/category&gt;&lt;description&gt;Extending the sys_choice table is not supported.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0538947&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Choice table should not be extended&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Reevaluate the requirements behind this and remove the extended tables:
- Different process-related requirements should be tackled by standardizing processes at an organizational level&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Choice table should not be extended&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;7fe8e03287ae1150fc79edbe8bbb35a7&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Choice table should not be extended&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_7fe8e03287ae1150fc79edbe8bbb35a7&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-2090303011</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>556e9ec2878042507bd12fce8bbb35da</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3980000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Choice table should not be extended</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>964c6c7656ae1150a84f4c0c55302b5b</update_guid>
<update_guid_history>964c6c7656ae1150a84f4c0c55302b5b:-2090303011,33e8e0320eae11509c9d570ae536d8a9:-361791791</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_2fe8e03287ae1150fc79edbe8bbb3511</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Reference field should not be the first field in the list view as this opens the reference record but not the current table record&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/sandiego-platform-administration/page/administer/list-administration/task/t_ConfigureTheListLayout.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Reference field should not be the first field in the list view&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Reference field should not be the first field in the list view as this opens the reference record but not the current table record.

Follow the below steps to fix-

1. Navigate to AES
2. Click on Data and locate the table for which list layout needs to be updated
3. Open the table and click on "Preview" button. This opens the list layout.
4. Right click on the list header. Select Configure &amp;gt; List Layout. This opens the sluchbucket page.
5. Change the order of reference field other than first position.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Declare variables
 var tableID = engine.current.getValue("sys_id");
 var tableName = engine.current.getValue("name");
 
 // Count number of fields in the list view
 var listElements = new GlideRecord('sys_ui_list_element');
 listElements.addQuery('list_id',tableID);
 listElements.orderBy('position');
 listElements.query();
 if(listElements.next()) {
  var sysDictionary = new GlideRecord('sys_dictionary');
  sysDictionary.addQuery('name',tableName);
  sysDictionary.addQuery('element',listElements.getValue('element'));
  sysDictionary.addQuery('internal_type.name','reference');
  sysDictionary.query();
  if(sysDictionary.next()) {
   engine.finding.increment();
  }
  
 }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Reference field should not be the first field in the list view&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;2fe8e03287ae1150fc79edbe8bbb3511&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Reference field should not be the first field in the list view&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_2fe8e03287ae1150fc79edbe8bbb3511&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1521302132</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>596e9ec2878042507bd12fce8bbb35d6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac27a0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Reference field should not be the first field in the list view</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>c24c2c768aae1150468580220c89bcf1</update_guid>
<update_guid_history>c24c2c768aae1150468580220c89bcf1:-1521302132,efe8e03257ae11509c282a2acba84a12:2096815896</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_77e8e03287ae1150fc79edbe8bbb3595</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;security&lt;/category&gt;&lt;description&gt;The platform is Javascript and a lot of code is run in a global variable scope.

A "gr" defined in one business rule can clobber another "gr" defined in some other script, which happens to be running as part of the same update or transaction. One 'gr' can be replaced by the other 'gr' for something completely unrelated, and your script will continue running subsequent lines thinking it is the one it defined.

Your script could end up returning no query result, or updating a different record, from even a different table, than the one you have just queried for in your script. That can clearly have serious implications.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0713029&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Do not use gr as a variable name&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;You could wrap your scripts in a function to avoid your script clobbering another gr, which is why new business rules, calculated fields, etc. mostly now have a default script added to wrap the code to protect the variables within the function, but most scripts and including older business rules don't require this. Wrapping your code in a function is good coding practice, so always do this.

When using more than one GlideRecord in your script, you may also accidentally re-use the gr name. The best practice is to use your own unique variable names, relevant to the table you are using, and never use 'gr'.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {
 
 /** 
   * The following to exclude certain tables like sys_script_execution_history 
   * from being part of this scan is NOT possible here due to app scoping issues
   * (https://github.com/ServiceNowDevProgram/example-instancescan-checks/issues/9)
   */
 //var excludedTablesProp = gs.getProperty(/* custom property name here */);
 //var excludedTables = excludedTablesProp.split(',');
 //var tableName = engine.current.getTableName();
 //if (!new ArrayUtil().contains(excludedTables, tableName)) {
  
    engine.rootNode.visit(function(node) {
  if (node.getTypeName() === "NAME" 
   &amp;&amp; node.getParent().getTypeName() === "VAR" 
   &amp;&amp; node.getNameIdentifier() === "gr") {
   
   engine.finding.incrementWithNode(node);
  }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Do not use gr as a variable name&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;77e8e03287ae1150fc79edbe8bbb3595&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Do not use gr as a variable name&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_77e8e03287ae1150fc79edbe8bbb3595&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1482927434</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>596e9ec2878042507bd12fce8bbb35d9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3680000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Do not use gr as a variable name</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>8a4c6c7661ae115003af1d9b0b974a48</update_guid>
<update_guid_history>8a4c6c7661ae115003af1d9b0b974a48:-1482927434,3be8e03280ae1150165dd3055409e696:-2125593534</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_23e8e03287ae1150fc79edbe8bbb354b</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;The scope of all the updates in the update set has to match the scope of the update set itself. That is all the customer updates have to be in the same scope as the scope of the update set. If this is not the case, upon previewing the retrieved update set on another instance, you will be presented with errors and won't be able to commit the update set.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0743551&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Update Scope Id is different than Update Set Scope Id&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;You may want to remove the customer update entries. Another option might be to manually move the customer update to a retrieved update set that is in the same scope. After that, if you preview the update set the preview problem will no longer persist.&lt;/resolution_details&gt;&lt;run_condition&gt;gs.getProperty('sn_appclient.instance_type') != 'production'&lt;/run_condition&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Update Scope Id is different than Update Set Scope Id&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;23e8e03287ae1150fc79edbe8bbb354b&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Update Scope Id is different than Update Set Scope Id&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_23e8e03287ae1150fc79edbe8bbb354b&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>2082345966</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>5d6e9ec2878042507bd12fce8bbb35d5</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2320000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Update Scope Id is different than Update Set Scope Id</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>f54c2c76a4ae11505921af312f3501de</update_guid>
<update_guid_history>f54c2c76a4ae11505921af312f3501de:2082345966,e3e8e03233ae11501a3286452581cf4c:-628231710</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_6be8e03287ae1150fc79edbe8bbb3526</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;UI Actions without conditions may allow unintended users to update/delete records.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/csh?topicname=t_EditingAUIAction.html&amp;amp;version=latest&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;UI Buttons without conditions&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Define conditions on UI Action to control its visibility to the intended users.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;UI Actions without conditions may cause unintended results&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;6be8e03287ae1150fc79edbe8bbb3526&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;UI Buttons without conditions&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_6be8e03287ae1150fc79edbe8bbb3526&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1133245527</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>5d6e9ec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3190000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>UI Buttons without conditions</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>8e4c6c761eae115099c72840deefb135</update_guid>
<update_guid_history>8e4c6c761eae115099c72840deefb135:1133245527,abe8e032c9ae1150819d4b2ae745ca40:-1400894901</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_a3e8e03287ae1150fc79edbe8bbb350d</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Utilize ServiceNow provided functions for evaluating conditions in Business rules and avoid using javascript based matehmatical operators for enhanced performance.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Business rules operators usage&lt;/name&gt;&lt;priority&gt;4&lt;/priority&gt;&lt;resolution_details&gt;Utilize ServiceNow provided functions for evaluating conditions in Business rules and avoid using javascript based matehmatical operators for enhanced performance.

Here are the steps to fix the issue-

1. Use current.&amp;lt;field_name&amp;gt; .changes(), instead of '==' operator or '!=' operator, as condition script to check change in value of a field
2. Use current.&amp;lt;field_name&amp;gt; .changesTo('&amp;lt;value&amp;gt;') and current.&amp;lt;field_name&amp;gt; .changesFrom('&amp;lt;value&amp;gt;'), instead of '==' operator, if the business rule should fire on change of a field to a specific &amp;lt;value&amp;gt;
3. Use current.&amp;lt;field_name&amp;gt;.nil() to check the emptiness of field&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Business rules operators usage&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;a3e8e03287ae1150fc79edbe8bbb350d&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Business rules operators usage&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_a3e8e03287ae1150fc79edbe8bbb350d&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-910653142</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>616e9ec2878042507bd12fce8bbb35db</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3c30000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Business rules operators usage</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>924c6c76ccae1150267617d153e04f6e</update_guid>
<update_guid_history>924c6c76ccae1150267617d153e04f6e:-910653142,67e8e03274ae115097d883a15084de0e:1631829534</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_c8f8e03287ae1150fc79edbe8bbb35b5</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;upgradability&lt;/category&gt;&lt;description&gt;When using the operator ^NQ in an encoded query within a business rule, the results appear in the list view, but the reference links are not correct.
A filter on a business rule that has a query with the operator ^NQ (second level condition) is applied only on the first part of the query. Although the business rule works correctly in the list, if a filter like Active=true is added, the filter is applied only on the first part of the query (before the ^NQ).&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0564887&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Detect any ^NQ in business rules&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;This is expected behavior. The NQ (top level OR) operator will 'OR' all previous query terms with following query terms. When there are no previous query terms, it is equivalent to regular 'OR'. Adjust the business Rule to not use the NQ Operator or disable the Business rule. Check documentation for more information.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(finding, current) {

    var instanceTroubleshooterUtil = new sn_troubleshooter.InstanceTroubleshooterUtil();
    if (instanceTroubleshooterUtil.isCustomerRecord(current.getTableName(), current.sys_id)) {
        finding.setCurrentSource(current);
        finding.increment();
    }

})(finding, current);]]&gt;&lt;/script&gt;&lt;short_description&gt;Using operator (^NQ) in encoded queries causes incorrect reference links&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;c8f8e03287ae1150fc79edbe8bbb35b5&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Detect any ^NQ in business rules&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_c8f8e03287ae1150fc79edbe8bbb35b5&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-992194063</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>616e9ec2878042507bd12fce8bbb35de</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4990000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Detect any ^NQ in business rules</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>2a4cac765bae11506c4986b2f8ad1335</update_guid>
<update_guid_history>2a4cac765bae11506c4986b2f8ad1335:-992194063,8cf8e032acae115091f0b21f404940b6:-1645334811</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_ffe8e03287ae1150fc79edbe8bbb3599</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;A global client script is any client script where the selected Table is Global. Global client scripts have no table restrictions; therefore they will load on every page in the system introducing browser load delay in the process. There is no benefit to loading this kind of scripts on every page.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/guides/rome/now-platform/tpb-guide/client_scripting_technical_best_practices#client-scripting-practices-to-avoid-&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Avoid Global Client Scripts&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;As an alternative, and for a more modular and scalable approach, consider moving client scripts to a base table (such as Task [task] or Configuration Item [cmdb_ci]) that can be inherited for all the child/extending tables. This eliminates the system loading the scripts on every form in the UI - such as home pages or Service Catalog where they are rarely (if ever) needed.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Avoid Global Client Scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;ffe8e03287ae1150fc79edbe8bbb3599&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Avoid Global Client Scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_ffe8e03287ae1150fc79edbe8bbb3599&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-2088625190</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>616edec2878042507bd12fce8bbb35d9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac5370000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Avoid Global Client Scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>624cac764cae11505dea9284c27b3293</update_guid>
<update_guid_history>624cac764cae11505dea9284c27b3293:-2088625190,b3e8e0323cae11505c388fbd646fde9b:37046118</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_bfe8e03287ae1150fc79edbe8bbb3558</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Updates in the wrong update set scope may generate an error like the following when previewed: 

Cannot commit Update Set 'UPDATE_SET_NAME' because: Update scope id 'x' is different than update set scope id 'y'. Resolve the problem before committing.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Updates in wrong update set scope&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;The scope of the Customer Update [sys_update_xml] record should match the scope of the Update Set in which it resides.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Updates in wrong update set scope&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;bfe8e03287ae1150fc79edbe8bbb3558&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Updates in wrong update set scope&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_bfe8e03287ae1150fc79edbe8bbb3558&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>535918305</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>656e9ec2878042507bd12fce8bbb35dd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac46f0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Updates in wrong update set scope</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>9e4cac767cae1150b15d2ec0dd2f9209</update_guid>
<update_guid_history>9e4cac767cae1150b15d2ec0dd2f9209:535918305,3be8e032eaae1150e5933ac0867cc866:-1137734035</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_f3e8e03287ae1150fc79edbe8bbb35a3</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;In general, you should use the object literal notation when possible. It is easier to read, it gives the compiler a chance to optimize your code, and it's mostly faster too.&lt;/description&gt;&lt;documentation_url&gt;https://www.java67.com/2014/08/difference-between-string-literal-and-new-String-object-Java.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Don't use new Object()&lt;/name&gt;&lt;priority&gt;4&lt;/priority&gt;&lt;resolution_details&gt;Use {} instead of new Object().&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

 // Perform Linter Check
 engine.rootNode.visit(function(node) {
  if(node.getTypeName() === "NAME" &amp;&amp;
     node.getNameIdentifier() === "Object" &amp;&amp;
     node.getParent().getTypeName() === "NEW") {
   // Create scan finding
   engine.finding.incrementWithNode(node);
  }
 });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Don't use new Object()&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;f3e8e03287ae1150fc79edbe8bbb35a3&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Don't use new Object()&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_f3e8e03287ae1150fc79edbe8bbb35a3&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-217830278</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>656edec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac50d0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Don't use new Object()</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>664cac764dae1150500c29906442e080</update_guid>
<update_guid_history>664cac764dae1150500c29906442e080:-217830278,b7e8e032d5ae115011dacecf6cfc4fa4:1282541574</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_b7e8e03287ae1150fc79edbe8bbb358e</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;A business rule is triggered whenever a user opens a list or form view or when a user inserts/updates or deletes a record. Without any conditions added, it will always evaluate to true and triggerred at all times. This can add to the performance increasing server processing time and hence it is recommended to restrict business rule execution by either adding a condition or filter condition or a role condition and preventing its execution unless it is necessary.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Business Rule without any conditions&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Define a condition on the Condition field or the Filter Condition or the Role Condition, the system will first evaluate these conditions and only then proceed to the execution of business rule script. If the condition fails, then the script wont execute. This will improve system performance and user experience.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Business Rule without any Condition, Filter Conditions and Role conditions&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;b7e8e03287ae1150fc79edbe8bbb358e&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Business Rule without any conditions&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_b7e8e03287ae1150fc79edbe8bbb358e&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-771769166</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>696e9ec2878042507bd12fce8bbb35dc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4370000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Business Rule without any conditions</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>da4c6c760aae1150b602bd403f8557ea</update_guid>
<update_guid_history>da4c6c760aae1150b602bd403f8557ea:-771769166,7be8e032fdae11509e5f98c8d43a738f:-429892802</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_ebe8a03287ae1150fc79edbe8bbb35e8</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Club all the onLoad() client scripts into one, otherwise, all the onLoad() client scripts will get executed randomly which may delay loading of the page.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Merge onLoad() client scripts&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Club all the onLoad() client scripts into one, otherwise, all the onLoad() client scripts will get executed randomly which may delay loading of the page.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    // Declare the variables
    var tableName = engine.current.getValue('table');

    // Count number of active onLoad client scripts for application table
    var aggScripts = new GlideAggregate('sys_script_client');
    aggScripts.addQuery('type', 'onLoad');
    aggScripts.addQuery('table', tableName);
    aggScripts.addActiveQuery();
    aggScripts.addAggregate('COUNT', 'table');
    aggScripts.query();
    if (aggScripts.next()) {
        var scriptCount = aggScripts.getAggregate('COUNT', 'table');
        if (scriptCount &gt; 1) {
            engine.finding.setCurrentSource(tableName);
            engine.finding.increment();
        }
    }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Merge onLoad() client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;ebe8a03287ae1150fc79edbe8bbb35e8&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Merge onLoad() client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_ebe8a03287ae1150fc79edbe8bbb35e8&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>605171845</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>696edec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4cb0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Merge onLoad() client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>6a4cac76ccae1150692409175826636d</update_guid>
<update_guid_history>6a4cac76ccae1150692409175826636d:605171845,2fe8e0320fae11505e28d0433bc73f02:-491045103</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_abe8a03287ae1150fc79edbe8bbb3567</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;security&lt;/category&gt;&lt;description&gt;A custom application which has "runtime access " set to tracking will be changed to enforced automatically during app installation on the target instance.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/rome-application-development/page/build/applications/reference/c_CrossScopePrivilegeRecord.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Runtime Access Tracking Validation&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt; A custom application which has "runtime access " set to tracking will be changed to enforced automatically during app installation on the target instance.
 During testing, application developers should run all their application scripting logic to ensure the system creates any necessary cross-scope privilege records. After application publication, the system only allows runtime requests to run that have a valid cross-scope privilege record.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

 // Declare variables
 var scopeID = engine.current.getValue('scope');
 
    // If no cross scope privilege record exists 
 var crossScope = new GlideRecord('sys_scope_privilege');
 crossScope.addQuery('source_scope',scopeID);
 crossScope.setLimit(1);
 crossScope.query();
 if(!crossScope.next()) {
  engine.finding.increment();
 }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Runtime Access Tracking Validation&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;abe8a03287ae1150fc79edbe8bbb3567&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Runtime Access Tracking Validation&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_abe8a03287ae1150fc79edbe8bbb3567&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>678775472</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>6d6e9ec2878042507bd12fce8bbb35db</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4060000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Runtime Access Tracking Validation</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>1a4c6c7655ae1150f28511eba14d14cb</update_guid>
<update_guid_history>1a4c6c7655ae1150f28511eba14d14cb:678775472,27e8a03273ae1150d31e0e28762c1d69:76662436</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_37e8e03287ae1150fc79edbe8bbb3554</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;security&lt;/category&gt;&lt;description&gt;The developer or system administrator should review any open restricted caller access privilege records. Reviewing to decide if cross-scope access to an application, application resource (such as an access control role, a business rule, a UI action, or a script include), or event should be allowed or denied.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/csh?topicname=requested-rca.html&amp;amp;version=latest&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Requested Restricted Caller Access Privileges&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Review any restricted caller access privilege records with status "Requested".&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Requested Restricted Caller Access Privileges&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;37e8e03287ae1150fc79edbe8bbb3554&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Requested Restricted Caller Access Privileges&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_37e8e03287ae1150fc79edbe8bbb3554&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1418034911</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>916e9ec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2980000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Requested Restricted Caller Access Privileges</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>064c2c76d8ae115066e01a70bc88afff</update_guid>
<update_guid_history>064c2c76d8ae115066e01a70bc88afff:-1418034911,f7e8e032bfae1150b626ec796d46ba55:-1538745683</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_7be8e03287ae1150fc79edbe8bbb359e</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;The "gs.log()", "gs.debug()", "console.log()", etc. statements can be used to write information to the system log, while the "gs.print()", etc. statements also sends it as output to the screen. It is generally used when debugging. Using "gs.log()", "gs.debug()", "console.log()", etc. statements on a production instance will pollute the system log, while it is never used as you do not perform debugging on a production instance.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Scripts should not contain debugging statements in production&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;The best practice is to remove (commented) debug statements from scripts or making them conditionally controlled by a property.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

 engine.rootNode.visit(function(node) {
  // gs.log, gs.info, gs.debug, gs.print
  if(node.getTypeName() === "GETPROP") {
   var gs_found = false;
   var method_found = false;

   node.visit(function(childnode) {
    if(childnode.getTypeName() != "NAME") {
     return;
    }

    if(childnode.getNameIdentifier() === "log" || childnode.getNameIdentifier() === "info" || childnode.getNameIdentifier() === "debug" || childnode.getNameIdentifier() === "print") {
     method_found = true;
     return;
    }

    if(childnode.getNameIdentifier() === "gs") {
     gs_found = true;
     return;
    }
   });

   // Create scan finding
   if(gs_found &amp;&amp; method_found) {
    engine.finding.incrementWithNode(node);
   }
  }
  
  // console.log
  if(node.getTypeName() === "GETPROP") {
   var console_found = false;
   var log_found = false;

   node.visit(function(childnode) {
    if(childnode.getTypeName() != "NAME") {
     return;
    }

    if(childnode.getNameIdentifier() === "log") {
     log_found = true;
     return;
    }

    if(childnode.getNameIdentifier() === "console") {
     console_found = true;
     return;
    }
   });

   // Create scan finding
   if(console_found &amp;&amp; log_found) {
    engine.finding.incrementWithNode(node);
   }
  }
  
  // jslog
  if(node.getNameIdentifier() &amp;&amp; node.getTypeName() === 'NAME' &amp;&amp; node.getNameIdentifier() === 'jslog' &amp;&amp; node.getParent().getTypeName() === 'CALL') {
   // Create scan finding
   engine.finding.incrementWithNode(node);
  }

 });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Scripts should not contain debugging statements in production&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;7be8e03287ae1150fc79edbe8bbb359e&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Scripts should not contain debugging statements in production&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_7be8e03287ae1150fc79edbe8bbb359e&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1076556710</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>916e9ec2878042507bd12fce8bbb35da</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac38b0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Scripts should not contain debugging statements in production</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>da4c6c76e0ae11506f67fe0b27b71956</update_guid>
<update_guid_history>da4c6c76e0ae11506f67fe0b27b71956:-1076556710,3fe8e03294ae11503b6c521bcad92c9f:-1760239898</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_2fe8a03287ae1150fc79edbe8bbb35e1</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Client Scripts without a function cause issues with variable scope. This is why Client Scripts are enclosed in a function by default. When code is not enclosed in a function, variables and other objects are available and shared to all other client-side scripts. If you're using the same variable names, it is possible they could collide.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/guides/sandiego/now-platform/tpb-guide/client_scripting_technical_best_practices#enclose-code-in-functions&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Enclose code in functions&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Client Scripts without a function cause issues with variable scope. This is why Client Scripts are enclosed in a function by default. When code is not enclosed in a function, variables and other objects are available and shared to all other client-side scripts. If you're using the same variable names, it is possible they could collide. This can lead to unexpected consequences that are difficult to troubleshoot. Consider this example:

******************************************************************************************
var state = "6";
function onSubmit() {
   if(g_form.getValue('incident_state') == state) {
     alert("This incident is Resolved");
   }
}

******************************************************************************************
Because the state variable is not enclosed in a function, all client-side scripts, have access to it. Other scripts may also use the common variable name state. The duplicate names can conflict and lead to unexpected results. These issues are very difficult to isolate and resolve. To avoid this issue, ensure all your code is wrapped in a function:

******************************************************************************************
function onSubmit() {
   var state = "6";
   if(g_form.getValue('incident_state') == state) {
     alert("This incident is Resolved");
   }
}

******************************************************************************************
This solution is much safer because the scope of the variable state is limited to the onSubmit() function. Therefore, the state variable does not conflict with state variables in other client-side scripts.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    engine.rootNode.visit(function(node) {
        if (node.getNameIdentifier() &amp;&amp;
            node.getTypeName() === 'NAME' &amp;&amp;
            (node.getNameIdentifier() === 'onSubmit' || node.getNameIdentifier() === 'onLoad'|| node.getNameIdentifier() === 'onChange'|| node.getNameIdentifier() === 'onCellEdit')) {
            engine.rootNode.visit(function(node) {
                if (node.getTypeName() === 'VAR' &amp;&amp;
                    node.getParent().getTypeName() === 'SCRIPT') {
                    engine.finding.incrementWithNode(node);
                }
            });
        }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Enclose code in functions&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;2fe8a03287ae1150fc79edbe8bbb35e1&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Enclose code in functions&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_2fe8a03287ae1150fc79edbe8bbb35e1&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1751634659</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>956e9ec2878042507bd12fce8bbb35d6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2700000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Enclose code in functions</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>0a4c2c76e5ae1150d6b5a63133e646ec</update_guid>
<update_guid_history>0a4c2c76e5ae1150d6b5a63133e646ec:-1751634659,efe8a0327cae1150144bf522091c4fe2:1087905553</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_77e8e03287ae1150fc79edbe8bbb354d</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;In general, for a single record only a few Workflow context will be running. If a high number of Workflow context are active, this often indicates an issue on the starting conditions of your Workflow. More then 10 active Workflow context is considered being a high number.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;High number of workflows running for a single record&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Resolve the high number of triggered Workflow context and investigate the starting conditions of your Workflow and correct where necessary.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

 // Count record
 var countRecord = new GlideAggregate('wf_context');
 countRecord.addEncodedQuery('active=true^state=executing');
 countRecord.groupBy('id');
 countRecord.addAggregate('COUNT');
 countRecord._query();

 while(countRecord._next()) {
  if(countRecord.getAggregate('COUNT') &gt; 10) {
   // Get record
   var getRecord = new GlideRecord('wf_context');
   getRecord.addQuery('id', countRecord.id);
   getRecord.setLimit(1);
   getRecord._query();

   if(getRecord._next()) {
    // Create scan finding
    var createFinding = new GlideRecord(getRecord.getValue('table'));

    if(createFinding.get(getRecord.getValue('id'))) {
     engine.finding.setCurrentSource(createFinding);
     engine.finding.increment();
    }
   }
  }
 }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;High number of workflows running for a single record&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;77e8e03287ae1150fc79edbe8bbb354d&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;High number of workflows running for a single record&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_77e8e03287ae1150fc79edbe8bbb354d&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1107707846</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>956e9ec2878042507bd12fce8bbb35d9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3570000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>High number of workflows running for a single record</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>ce4c6c765eae115087efa8c05234f543</update_guid>
<update_guid_history>ce4c6c765eae115087efa8c05234f543:-1107707846,3be8e032fcae1150d89c2d4a271ac04e:1946404654</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_23e8e03287ae1150fc79edbe8bbb351b</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Every choice list value is labeled "proper case" with the first word beginning with a capital letter and the following words are lower case (i.e. On Hold, Awaiting Customer and User Experience). This is an out-of-box convention within Service-now.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Choices label to be in proper case&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Every choice list value is labeled "proper case" with the first word beginning with a capital letter and the following words are lower case (i.e. On Hold, Awaiting Customer and User Experience). This is an out-of-box convention within Service-now.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    // Define variables
    var regExpFirstChar = /^[A-Z]/;
    var regExpAllUpperCaseChar = /^[^a-z]*$/;
    var regExpAllLowerCaseChar = /^[^A-Z]*$/;
 var choiceLabel = '';
   
    // Get choices without proper case
    var grChoice = new GlideRecord('sys_choice');
    grChoice.addQuery('element', engine.current.element);
 grChoice.addQuery('inactive',false);
    grChoice.query();
    while (grChoice.next()) {
        choiceLabel = grChoice.label.split(' ');
        for (var i = 0; i &lt; choiceLabel.length; i++) {
            if (!regExpFirstChar.test(choiceLabel[i]) || regExpAllUpperCaseChar.test(choiceLabel[i]) || regExpAllLowerCaseChar.test(choiceLabel[i])) {
                engine.finding.setCurrentSource(grChoice); 
    engine.finding.increment();
            }
        }
    }
})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Choices label to be in proper case&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;23e8e03287ae1150fc79edbe8bbb351b&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Choices label to be in proper case&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_23e8e03287ae1150fc79edbe8bbb351b&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-408153638</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>996e9ec2878042507bd12fce8bbb35d5</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac22a0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Choices label to be in proper case</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>3d4c2c761bae115027e8e6e531e418d9</update_guid>
<update_guid_history>3d4c2c761bae115027e8e6e531e418d9:-408153638,e3e8e03256ae1150acc3b1234bf3ca1c:1207000166</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_67e8e03287ae1150fc79edbe8bbb351d</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;All the first letters in the table name should be in upper case and also it should not be ended with "s" as ServiceNow automatically display plural name while displaying multiple records in list view e.g., Case Trackers is displayed automatically in ServiceNow&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Table label should be in proper case&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;1. Open the Table in App Engine Studio via Table Builder
2. Click on the "Properties" button displayed on the right side of the screen in Table Builder. This should open table properties.
3. Update the "Table label" to fix the issue.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    // Define variables
    var regexp = /^[A-Z]/;
    var regExpAllUpperCaseChar = /^[^a-z]*$/;
    var regExpAllLowerCaseChar = /^[^A-Z]*$/;
    var tableName = engine.current.label.toString();

    // Check for plural in label
    var lastChar = tableName.charAt(tableName.length - 1);
    if (lastChar == 's') {
        engine.finding.increment();
    }

    // Get tables without proper case
    tableName = tableName.split(' ');
    for (var i = 0; i &lt; tableName.length; i++) {
        if (!regexp.test(tableName[i]) || regExpAllUpperCaseChar.test(tableName[i]) || regExpAllLowerCaseChar.test(tableName[i])) {
            engine.finding.increment();
        }
    }


})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Table label should be in proper case and should not be plural e.g., Case Tracker&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;67e8e03287ae1150fc79edbe8bbb351d&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Table label should be in proper case&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_67e8e03287ae1150fc79edbe8bbb351d&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1911987725</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>996e9ec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac30e0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Table label should be in proper case</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>c24c6c7608ae11501309c9adf5575a31</update_guid>
<update_guid_history>c24c6c7608ae11501309c9adf5575a31:1911987725,2be8e032deae1150000ea515b29d071e:-1050926695</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_40f8e03287ae1150fc79edbe8bbb35b1</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;When two Script Includes exist with the same name in the same scope, when those script includes are called it is unreliable as to which Script Include will actually be instantiated.&lt;/description&gt;&lt;documentation_url&gt;http://docs.servicenow.com/csh?topicname=c_ScriptIncludes.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Duplicate Script Include Name&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Ensure all your Script Includes have unique names. Rename any script include with a duplicate name with a unique name.d&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(finding, current) {

// gs.info(current.api_name);
// gs.info('Checking script Include name: ' + current.api_name);
    var ga = new GlideAggregate('sys_script_include');
    ga.addQuery('api_name', current.api_name);
    ga.addAggregate('COUNT');
    ga.query();
    ga.next();

    if (ga.getAggregate('COUNT') &gt;= 2) {
        finding.increment();
  finding.count = ga.getAggregate('COUNT');
 }
})(finding, current);]]&gt;&lt;/script&gt;&lt;short_description&gt;Duplicate Script Include Names&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;40f8e03287ae1150fc79edbe8bbb35b1&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Duplicate Script Include Name&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_40f8e03287ae1150fc79edbe8bbb35b1&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-2029333667</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>9d6e9ec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2dc0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Duplicate Script Include Name</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>024c6c76c7ae11504dce94969b8cd112</update_guid>
<update_guid_history>024c6c76c7ae11504dce94969b8cd112:-2029333667,04f8e03280ae11505e57d67ff8adc0b2:783650793</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_bbe8e03287ae1150fc79edbe8bbb3597</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;A global Business Rule is any Business Rule where the selected Table is Global. Any other script can call global Business Rules. Global Business Rules have no condition or table restrictions and load on every page in the system. Most functions defined in global Business Rules are fairly specific, such as an advanced reference qualifier on one field of one form. There is no benefit to loading this kind of script on every page.

Script includes only load when called.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/guides/rome/now-platform/tpb-guide/business_rules_technical_best_practices&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Use Script Includes Instead of Global Business Rules&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;If you have already written a global Business Rule, move the function definition to a Script Include. The name of the Script Include must match the name of the function for the Script Include to work properly. There is no need to modify any calls to the named function.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Use Script Includes Instead of Global Business Rules&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;bbe8e03287ae1150fc79edbe8bbb3597&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Use Script Includes Instead of Global Business Rules&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_bbe8e03287ae1150fc79edbe8bbb3597&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1284061547</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>a16e9ec2878042507bd12fce8bbb35dd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4630000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Use Script Includes Instead of Global Business Rules</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>d24cac76ceae11509640b31c35616305</update_guid>
<update_guid_history>d24cac76ceae11509640b31c35616305:-1284061547,7fe8e032f7ae115082177bcc07ffc198:-508029407</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_efe8e03287ae1150fc79edbe8bbb3521</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;ACLs without roles or condition or scripts may allow unintended users to update/delete/create/read records.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;ACLs without roles or condition or scripts&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Review ACL and do one of the following:
a) Add required roles or condition or scripts to the ACLs
b) Disable and validate if ACL is not needed, if after 7 days no issues, take XML backup and delete.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    // Get current ACL
    var grACL = new GlideRecord('sys_security_acl');
    if (grACL.get(engine.current.sys_id)) {
        if (engine.current.script == '' &amp;&amp; engine.current.condition == '') { // If ACL without condition/script
            var aclsRoleGr = new GlideRecord('sys_security_acl_role'); //Check if the ACL has a role defined.
            aclsRoleGr.addQuery('sys_security_acl', grACL.sys_id);
            aclsRoleGr.setLimit(1);
            aclsRoleGr.query();
            if (!aclsRoleGr.next()) { // If the ACL has no role, get the specific ACL GlideRecord and create finding
                engine.finding.increment();
            }
        }
    }


})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;ACLs without roles or condition or scripts may cause unintended results&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;efe8e03287ae1150fc79edbe8bbb3521&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;ACLs without roles or condition or scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_efe8e03287ae1150fc79edbe8bbb3521&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-407652737</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>a16edec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4fb0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>ACLs without roles or condition or scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>aa4cac76f7ae11505e959a6ad2830d7b</update_guid>
<update_guid_history>aa4cac76f7ae11505e959a6ad2830d7b:-407652737,a3e8e032a6ae11502be513bd079a9023:-897591437</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_afe8e03287ae1150fc79edbe8bbb3503</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Avoid Document Object Model (DOM) manipulation if possible. It can cause a maintainability issue when browsers are updated.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/sandiego-application-development/page/script/client-scripts/concept/client-script-best-practices.html#r_AvoidDOMManipulation&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Avoid DOM manipulation&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Avoid Document Object Model (DOM) manipulation if possible. It can cause a maintainability issue when browsers are updated.

Instead, use the GlideForm API or consider a different approach for the solution. In general, when using DOM manipulation methods, you have to reference an element in the DOM by ID or using a CSS selector. When referencing out-of-box DOM elements, there is a risk that the element ID or placement within the DOM could change, causing the code to stop working and/or generate errors. Use forethought, caution, and have a full understanding of the risk you are incurring. Review these objects and reduce the use of DOM manipulation methods as much as possible.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    engine.rootNode.visit(function(node) {
        if (node.getNameIdentifier() &amp;&amp;
            node.getTypeName() === 'NAME' &amp;&amp;
            node.getParent().getTypeName() === 'GETPROP' &amp;&amp;
            node.getParent().getParent().getTypeName() === 'CALL' &amp;&amp;
            (node.getNameIdentifier() === 'document')) {
            node.getParent().visit(function(node) {
                if (node.getNameIdentifier() &amp;&amp;
                    node.getTypeName() === 'NAME' &amp;&amp;
                    node.getNameIdentifier() !== 'document') {
                    engine.finding.incrementWithNode(node);
                }
            });
        }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Avoid DOM manipulation&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;afe8e03287ae1150fc79edbe8bbb3503&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Avoid DOM manipulation&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_afe8e03287ae1150fc79edbe8bbb3503&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1685099837</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>a56e9ec2878042507bd12fce8bbb35dc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac42e0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Avoid DOM manipulation</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>5a4c6c7650ae1150cc799c88d93fdbd9</update_guid>
<update_guid_history>5a4c6c7650ae1150cc799c88d93fdbd9:-1685099837,63e8e0322eae115092e26a8a7cf21a05:-198218417</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_e7e8e03287ae1150fc79edbe8bbb350f</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Use Flows instead of Async or After Business rules. Async business rules are like after rules in that they run after the database commits a change. Unlike after rules, async rules run in the background simultaneously with other processes. Instead of Async or After business rules use Flows.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/en-US/bundle/sandiego-application-development/page/script/business-rules/concept/c_BusinessRules.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Use Flows instead of Async or After Business rules&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Use Flows instead of Async or After Business rules. Async business rules are like after rules in that they run after the database commits a change. Unlike after rules, async rules run in the background simultaneously with other processes. Instead of Async or After business rules use Flows.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Use Flows instead of Async or After Business rules&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;e7e8e03287ae1150fc79edbe8bbb350f&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Use Flows instead of Async or After Business rules&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_e7e8e03287ae1150fc79edbe8bbb350f&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>278836365</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>a56edec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4bc0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Use Flows instead of Async or After Business rules</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>ae4cac76ebae11509d02b267c9890968</update_guid>
<update_guid_history>ae4cac76ebae11509d02b267c9890968:278836365,abe8e032d4ae1150ae914e99540c1f10:-292518527</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_a7e8e03287ae1150fc79edbe8bbb3546</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;user_experience&lt;/category&gt;&lt;description&gt;The GlideAjax (Asynchronous) does not work on onSubmit Client Script. This is because of the fundamental behavior of Asynchronous scripts which are non-blocking by nature.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sys_kb_id=752ed2fddbfc0490d58ea345ca96196e&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Asynchronous AJAX call in on-submit client scripts&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Modify the client script as per the following documentation.
1) https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sys_kb_id=752ed2fddbfc0490d58ea345ca96196e
2) https://community.servicenow.com/community?id=community_blog&amp;amp;sys_id=dc49feeadbdd7f0c54250b55ca96191d&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    var clientScripts = new GlideRecord('sys_script_client');
    clientScripts.addQuery('sys_class_name', 'sys_script_client');
    clientScripts.addActiveQuery();
    // get all active on-submit custom client scripts with getXML/getXMLAnswer in it.
    clientScripts.addEncodedQuery("scriptLIKEgetXML(^ORscriptLIKEgetXMLAnswer^type=onSubmit^scriptNOT LIKEgetActionName");
    clientScripts.query();
    while (clientScripts.next()) {
        engine.finding.increment();
    }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Asynchronous AJAX call in on submit client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;a7e8e03287ae1150fc79edbe8bbb3546&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Asynchronous AJAX call in on-submit client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_a7e8e03287ae1150fc79edbe8bbb3546&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-141814981</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>a96e9ec2878042507bd12fce8bbb35db</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3fc0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Asynchronous AJAX call in on-submit client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>5e4c6c76b5ae115082937d3f4fa39ec6</update_guid>
<update_guid_history>5e4c6c76b5ae115082937d3f4fa39ec6:-141814981,6be8e03267ae1150424298d0f22e4c47:1639339719</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_a3e8a03287ae1150fc79edbe8bbb35dd</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Provide description to roles. This helps is identying the various personas associated with the application and it's needs.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/sandiego-application-development/page/build/app-engine-studio/concept/add-security.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Provide description to roles&lt;/name&gt;&lt;priority&gt;4&lt;/priority&gt;&lt;resolution_details&gt;Provide description to roles. This helps is identying the various personas associated with the application and it's needs. 

To fix the issue-

1. Navigate to AES
2. Pick up the right application
3. Navigate to the last tab "Security"
4. Select the role and pick "Edit" under "..." menu
5. Add description to the role clearly indicating it's purpose.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Provide description to roles&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;a3e8a03287ae1150fc79edbe8bbb35dd&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Provide description to roles&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_a3e8a03287ae1150fc79edbe8bbb35dd&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1875526331</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>ad6e9ec2878042507bd12fce8bbb35da</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3b70000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Provide description to roles</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>d64c6c76c7ae11503bff1ad702e62269</update_guid>
<update_guid_history>d64c6c76c7ae11503bff1ad702e62269:1875526331,67e8a03243ae11504833cb3261e6f5de:1360474439</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_c4f8e03287ae1150fc79edbe8bbb35ac</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;upgradability&lt;/category&gt;&lt;description&gt;The baseline restriction to extend the Incident table has been removed and at least one child table extending Incident has been created.
- To support a custom Incident table a high amount of customization to the other ITSM processes is required
- New functionality in future releases might not work on extended tables or would require further customization.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Incident table should not be extended&lt;/name&gt;&lt;priority&gt;1&lt;/priority&gt;&lt;resolution_details&gt;Reevaluate the requirements behind this and remove the extended tables:
- Different process-related requirements should be tackled by standardizing processes at an organizational level. 
- Non-ITSM Incidents, e.g. a Facility Incident, should be either build as a custom app or by leveraging existing applications on the ServiceNow store.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Extending Incident with custom child tables should not be done&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;c4f8e03287ae1150fc79edbe8bbb35ac&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Incident table should not be extended&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_c4f8e03287ae1150fc79edbe8bbb35ac&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>980636348</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>ad6e9ec2878042507bd12fce8bbb35dd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac48c0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Incident table should not be extended</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>a64cac7637ae1150d23091e370c71524</update_guid>
<update_guid_history>a64cac7637ae1150d23091e370c71524:980636348,88f8e03214ae11503c388e039b8a19ad:1047419824</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_ffe8e03287ae1150fc79edbe8bbb3569</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Query business rules that query themselves will continue to loop indefinitely until being caught by the platforms recursion limit. This can build up to an excessive response time and possibly cause the transaction to time out or create performance issues.

For example if the query business rule is on the 'incident' table the code should NOT contain statements such as the following:
var gr = new GlideRecord('incident');
gr.query();

This will result in the business rule calling itself again, which would then call itself again and continue indefinitely until caught by the platform.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0813039&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Query business rules should not use query() on GlideRecord&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;If this issue is identified please review and modify the code to make necessary changes to prevent recursion.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Query business rules should not use query() on GlideRecord&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;ffe8e03287ae1150fc79edbe8bbb3569&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Query business rules should not use query() on GlideRecord&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_ffe8e03287ae1150fc79edbe8bbb3569&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>861114851</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>ad6edec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac52b0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Query business rules should not use query() on GlideRecord</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>a64cac766dae11509ce7cc008f375e8e</update_guid>
<update_guid_history>a64cac766dae11509ce7cc008f375e8e:861114851,b3e8e0327dae1150e0bf1a419d92b26b:-39077417</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_2be8e03287ae1150fc79edbe8bbb3508</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Use g_form API instead of alert messages.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/reference/api/quebec/client/c_GlideFormAPI#r_GlideFormAddInfoMessage_String&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Use g_form API instead of alert messages&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Use g_form API instead of alert messages.

Utilize &amp;lt;&amp;lt;g_from&amp;gt;&amp;gt; class and its methods &amp;lt;&amp;lt;g_form.addInfoMessage()&amp;gt;&amp;gt; instead of &amp;lt;&amp;lt;alert()&amp;gt;&amp;gt; method.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    engine.rootNode.visit(function(node) {
        if (node.getNameIdentifier() &amp;&amp;
            node.getTypeName() === 'NAME' &amp;&amp;
            node.getParent().getTypeName() === 'CALL' &amp;&amp;
            (node.getNameIdentifier() === 'alert')) {
            engine.finding.incrementWithNode(node);
        }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Use g_form API instead of alert messages&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;2be8e03287ae1150fc79edbe8bbb3508&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Use g_form API instead of alert messages&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_2be8e03287ae1150fc79edbe8bbb3508&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1357603447</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>d16e9ec2878042507bd12fce8bbb35d6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2590000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Use g_form API instead of alert messages</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>4e4c2c762bae1150c69dfa8f158e9be7</update_guid>
<update_guid_history>4e4c2c762bae1150c69dfa8f158e9be7:1357603447,ebe8e032f8ae1150ed50fe9c4c6d0609:-486618621</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_73e8e03287ae1150fc79edbe8bbb358c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Hard coding instance URL is not a best practice as they reduce the usability of your code. The URL remains static and it does not change when you move the code to a different instance or it can get overwritten during clone backs. This can break the related functionalities or create unexpected results&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Hard coded Instance URL&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;For server side scripts, Use gs.getProperty("instance_name") for dynamic generation of URL
For client side scripts, you can either access the URL via scractpad from server side or use GlideURL() or top.location&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {
    var instanceName = gs.getProperty("instance_name");
    engine.rootNode.visit(function(node) {
        if (node.getTypeName() === "STRING") {
            //For any string variables or method arguments
            var text = node.toSource();
            if (text.indexOf(instanceName) &gt; -1)
                engine.finding.incrementWithNode(node);
        } 
    });
})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Usage of hard coded value for Instance name in URL or similar cases&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;73e8e03287ae1150fc79edbe8bbb358c&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Hard coded Instance URL&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_73e8e03287ae1150fc79edbe8bbb358c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>684244904</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>d16e9ec2878042507bd12fce8bbb35d9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac32e0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Hard coded Instance URL</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>064c6c761aae1150479a3c1a7ca25b3f</update_guid>
<update_guid_history>064c6c761aae1150479a3c1a7ca25b3f:684244904,37e8e0327eae115059edb74edd14258d:-1699020388</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_0cf8e03287ae1150fc79edbe8bbb35ae</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;getMessage used in a client script needs to have the message key added to the Messages field on the script record.&lt;/description&gt;&lt;documentation_url&gt;http://docs.servicenow.com/csh?topicname=t_TranslateAClientScriptMessage.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;getMessage() called in Client Script&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Use the messages field on the client script record to load the message key being used in getMessage().&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;getMessage() called in Client Script without preloading message key&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;0cf8e03287ae1150fc79edbe8bbb35ae&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;getMessage() called in Client Script&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_0cf8e03287ae1150fc79edbe8bbb35ae&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1102930239</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>d56e9ec2878042507bd12fce8bbb35d5</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac21e0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>getMessage() called in Client Script</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>b94c2c76ecae1150eafe1a651da429c8</update_guid>
<update_guid_history>b94c2c76ecae1150eafe1a651da429c8:1102930239,ccf8e032c8ae1150859eec1806f583af:-1894612021</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_63e8e03287ae1150fc79edbe8bbb3544</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;user_experience&lt;/category&gt;&lt;description&gt;Code that uses synchronous AJAX feels very slow and affects user experience.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0289269&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Synchronous AJAX call in client scripts&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;If using getXMLWait, replace with getXML and a callback function.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Synchronous AJAX call in client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;63e8e03287ae1150fc79edbe8bbb3544&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Synchronous AJAX call in client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_63e8e03287ae1150fc79edbe8bbb3544&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1770735598</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>d56e9ec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3030000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Synchronous AJAX call in client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>0a4c6c76e2ae115060f7482e738a5c2c</update_guid>
<update_guid_history>0a4c6c76e2ae115060f7482e738a5c2c:-1770735598,27e8e0321cae115091b3a0a771c7c545:671882910</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_3be8e03287ae1150fc79edbe8bbb35a5</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;security&lt;/category&gt;&lt;description&gt;The eval() function evaluates or executes an argument. Improper use of eval() opens up your code for injection attacks and debugging can be more challenging, as no line numbers are displayed with an error, for example.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/guides/rome/now-platform/tpb-guide/scripting_technical_best_practices#avoid-the-eval-function-&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Avoid the eval function&lt;/name&gt;&lt;priority&gt;1&lt;/priority&gt;&lt;resolution_details&gt;Consider the following code to achieve the same outcome:
GlideEvaluator.evaluateString("gs.log('Hello World');");&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    engine.rootNode.visit(function(node) {
        if (node.getTypeName() === "NAME" &amp;&amp;
            node.getNameIdentifier() === "eval" &amp;&amp;
            node.getParent().getTypeName() === "CALL") {
            engine.finding.incrementWithNode(node);
        }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Avoid the eval function&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;3be8e03287ae1150fc79edbe8bbb35a5&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Avoid the eval function&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_3be8e03287ae1150fc79edbe8bbb35a5&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-367145081</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>d96e9ec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac2d10000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Avoid the eval function</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>464c6c76c3ae11501a6596300285c70d</update_guid>
<update_guid_history>464c6c76c3ae11501a6596300285c70d:-367145081,fbe8e0325eae1150caa4e9673940caa6:-1423944685</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_84f8e03287ae1150fc79edbe8bbb35b3</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;user_experience&lt;/category&gt;&lt;description&gt;Code that uses synchronous AJAX feels very slow and affects user experience.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0289269&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Synchronous AJAX call in client scripts&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;If using getXMLWait, replace with getXML and a callback function.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (finding) {
 var updateVersionAPI = new global.UpdateVersionAPI(); // updateVersionAPI to find custom sys_metadata records
 var clientScripts = new GlideRecord('sys_script_client');
 clientScripts.addQuery('sys_class_name','sys_script_client');
 // get all active custom client scripts with getXMLWait in it.
    clientScripts.addEncodedQuery("active=true^scriptLIKEgetXMLWait"); 
 clientScripts.query();
 var resClientScripts = updateVersionAPI.getCustomerFileIds(clientScripts); // Find the custom clientscripts with getXMLWait
 if(resClientScripts.length &gt; 0){ //If there are custom client scripts using getXMLWait
  for (var i = 0; i &lt; resClientScripts.length; i++){
   var csGr = new GlideRecord('sys_script_client');
   // Get the specific client script and create finding records.
   csGr.get(resClientScripts[i]);
   finding.setCurrentSource(csGr); 
   finding.increment();
  }
 } 
})(finding);]]&gt;&lt;/script&gt;&lt;short_description&gt;Synchronous AJAX call in client scripts&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;84f8e03287ae1150fc79edbe8bbb35b3&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Synchronous AJAX call in client scripts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_84f8e03287ae1150fc79edbe8bbb35b3&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1197091046</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>d96e9ec2878042507bd12fce8bbb35da</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3ae0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Synchronous AJAX call in client scripts</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>1e4c6c762eae115068298369b4096464</update_guid>
<update_guid_history>1e4c6c762eae115068298369b4096464:1197091046,48f8e03239ae11507e5ea03cbba407b4:1809969522</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_33e8e03287ae1150fc79edbe8bbb3593</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Avoid using hard-coded values in scripts, as they can lead to unpredictable results and can be difficult to track down later. Hard coding sys_ids is not recommended, as they may not be the same between instances.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/guides/rome/now-platform/tpb-guide/scripting_technical_best_practices#do-not-use-hard-coded-values&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Do not use hard-coded sys_ids&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Instead, try looking up a value by reference or by creating a property and retrieving the value with gs.getProperty().&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    engine.rootNode.visit(function(node) {
  if (node.getTypeName() === "STRING") {
   var theString = node.toSource();
   
   // Looks for all occurences of a sys_id including as standalone strings
   // or those that are part of an encoded query where sys_id might be prefixed
   // With operator of = or STARTSWITH or IN or INSTANCEOF, etc
   var pattern = /("|'|=|h|H|n|N|f|F|,)[a-z0-9]{32}("|'|\^|,|@)/gm;
   
   var regExp = new RegExp(pattern);
   var matchFound = regExp.test(theString);
   if (matchFound)
    engine.finding.incrementWithNode(node);
  }
    });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Do not use hard-coded sys_ids&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;33e8e03287ae1150fc79edbe8bbb3593&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Do not use hard-coded sys_ids&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_33e8e03287ae1150fc79edbe8bbb3593&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>235313573</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>dd6e9ec2878042507bd12fce8bbb35d6</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac28d0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Do not use hard-coded sys_ids</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>4a4c2c7628ae1150be0ba8c9c2d60cfa</update_guid>
<update_guid_history>4a4c2c7628ae1150be0ba8c9c2d60cfa:235313573,f3e8e032ceae11502b9650101b855494:-1469061735</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_7be8e03287ae1150fc79edbe8bbb356e</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Before business rules execute before the data on current record is saved to database. In case, the before business rule fails or aborts its operation, then any insert operations within the business rule becomes invalid but it cannot be reverted back as the operation would have already been completed. In order to avoid such issues, before business rules should not include insert operations.&lt;/description&gt;&lt;documentation_url&gt;https://support.servicenow.com/kb?id=kb_article_view&amp;amp;sysparm_article=KB0722983&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Before Business rules should not insert() records in any table&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Move the insert operation from before business rule to  an after business rule so it executes only after the current record is saved to the database.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Before Business rules should not insert records in any table&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;7be8e03287ae1150fc79edbe8bbb356e&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Before Business rules should not insert() records in any table&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_7be8e03287ae1150fc79edbe8bbb356e&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>37264838</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>dd6e9ec2878042507bd12fce8bbb35d9</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3810000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Before Business rules should not insert() records in any table</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>124c6c76efae1150c536ee6cb9b6a952</update_guid>
<update_guid_history>124c6c76efae1150c536ee6cb9b6a952:37264838,3fe8e03274ae1150d5c552e2c8483a6f:-328843078</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_afe8a03287ae1150fc79edbe8bbb356a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;security&lt;/category&gt;&lt;description&gt;Runtime Access Tracking provides a way to logs the access to target resources from source application requested via scripts. For example, controlling the Read/Write operation in target application table or restricting the execution of script include in target application.&lt;/description&gt;&lt;documentation_url&gt;https://docs.servicenow.com/bundle/rome-application-development/page/build/applications/concept/c_RuntimeAccessTracking.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Runtime Access Tracking&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;This setting typically to be discussed with application or system adminstrator and then applied accordingly.

Runtime Access Tracking provides a way to logs the access to target resources from source application requested via scripts. For example, controlling the Read/Write operation in target application table or restricting the execution of script include in target application.

At minimum "Resource Access Tracking"  value should be set to "Tracking" (default option) which would record all the cross scope scripted access to application resources. When working with sensitive applications like HR, Legal then "Resource Access Tracking" value can be set to "Enforcing" which requires administrator approval before a resource access can be granted.

Here's brief overview of different options-
o None: All cross-scope privileges are granted automatically at runtime.
o Tracking: Allows application scripts to access resources from other applications. A record for the access is automatically inserted in the cross-scope access table with a Status value of Allowed. This is the default setting.
o Enforcing: Allows application scripts to access resources from other applications only after an admin authorizes the access. A record is automatically added to the cross-scope access table with a Status value of Requested.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Runtime Access Tracking&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;afe8a03287ae1150fc79edbe8bbb356a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Runtime Access Tracking&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_afe8a03287ae1150fc79edbe8bbb356a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-466499179</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>e16e9ec2878042507bd12fce8bbb35dc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac41f0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Runtime Access Tracking</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>9e4c6c76b0ae1150082150875f3295d4</update_guid>
<update_guid_history>9e4c6c76b0ae1150082150875f3295d4:-466499179,63e8a0322bae11503248490a7383236c:553297033</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_a7e8e03287ae1150fc79edbe8bbb3516</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;security&lt;/category&gt;&lt;description&gt;Every table should be secured by ACLs&lt;/description&gt;&lt;documentation_url&gt;http://docs.servicenow.com/csh?topicname=acl-rule-types.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Tables without ACLs&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;For tables that have no ACLs defined, the default deny property can be used to make the wildcard table ACL rules restrict the read, write, create, and delete operations on all tables unless the user has the admin role or meets the requirements of another table ACL rule. This means that custom tables without ACLs will not be accessible by any other user beside admin.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    // Find any ACL Record for the current able..
    var gr_acl = new GlideRecord('sys_security_acl');
    gr_acl.addQuery('name', 'STARTSWITH', engine.current.getValue('name'));
    gr_acl.addActiveQuery();
    gr_acl.setLimit(1); // one record is enough
    gr_acl.query();

    // no ACL record found, raise finding
    if (!gr_acl.hasNext()) {
        engine.finding.increment();
    }


})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Tables without ACLs&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;a7e8e03287ae1150fc79edbe8bbb3516&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Tables without ACLs&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_a7e8e03287ae1150fc79edbe8bbb3516&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>1653564462</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>e56e9ec2878042507bd12fce8bbb35db</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac3ee0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Tables without ACLs</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>1a4c6c76e8ae1150a6257d3052214977</update_guid>
<update_guid_history>1a4c6c76e8ae1150a6257d3052214977:1653564462,6be8e0322fae115021d6b70337cbea17:-619724614</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_e7e8a03287ae1150fc79edbe8bbb35df</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;security&lt;/category&gt;&lt;description&gt;Avoid "delete" ACL operation on the table as this may lead to accidental data loss.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Avoid "delete" ACL operation on table&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Avoid "delete" ACL operation on table as this may lead to accidental data loss.  This also applies to application adminsitartor role.

To fix the issue, you may either use True/False (if already exists) or create new one. Once True/False field is available then apply the Reference Qualifier to Reference fields to exclude inactive records. In addition to this, reports can also be updated to include the inactive filter condition.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Avoid "delete" ACL operation on the table&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:18&lt;/sys_created_on&gt;&lt;sys_id&gt;e7e8a03287ae1150fc79edbe8bbb35df&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Avoid "delete" ACL operation on table&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_e7e8a03287ae1150fc79edbe8bbb35df&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:18&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1919376442</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>e56e9ec2878042507bd12fce8bbb35de</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4b10000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Avoid "delete" ACL operation on table</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>ae4cac76ddae1150acf1c9388009ee3e</update_guid>
<update_guid_history>ae4cac76ddae1150acf1c9388009ee3e:-1919376442,abe8a03277ae1150766d2c81f69b92e0:1623230394</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_bfe8e03287ae1150fc79edbe8bbb35a0</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;In general, you should use the array literal notation when possible. It is easier to read, it gives the compiler a chance to optimize your code, and it's mostly faster too.&lt;/description&gt;&lt;documentation_url&gt;https://www.java67.com/2014/08/difference-between-string-literal-and-new-String-object-Java.html&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Don't use new Array()&lt;/name&gt;&lt;priority&gt;4&lt;/priority&gt;&lt;resolution_details&gt;Use [] instead of new Array().&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

 // Perform Linter Check
 engine.rootNode.visit(function(node) {
  if(node.getTypeName() === "NAME" &amp;&amp;
     node.getNameIdentifier() === "Array" &amp;&amp;
     node.getParent().getTypeName() === "NEW") {
   // Create scan finding
   engine.finding.incrementWithNode(node);
  }
 });

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Don't use new Array()&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;bfe8e03287ae1150fc79edbe8bbb35a0&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Don't use new Array()&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_bfe8e03287ae1150fc79edbe8bbb35a0&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-554733082</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>e96e9ec2878042507bd12fce8bbb35dd</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4820000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Don't use new Array()</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>ea4cac7688ae1150bfb0c4b752014e1f</update_guid>
<update_guid_history>ea4cac7688ae1150bfb0c4b752014e1f:-554733082,73e8e032b3ae1150db29b5a953c974a2:-392436110</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_ffe8e03287ae1150fc79edbe8bbb3551</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;Having a customer update in multiple in progress update sets could lead to collisions when promoting the customer updates to another environment. Or worse, when committing the customer update on another environment, it could revert work done with earlier updates or it could bring unintended updates to another environment.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Customer Update in progress in multiple Update Sets&lt;/name&gt;&lt;priority&gt;2&lt;/priority&gt;&lt;resolution_details&gt;Review the customer updates concerned and determine if this was just a mistake working in multiple update sets, if the customer update can be removed, if the update sets can be related using a batch update set, can one of the update sets be closed, etcetera.&lt;/resolution_details&gt;&lt;run_condition&gt;gs.getProperty('sn_appclient.instance_type') != 'production'&lt;/run_condition&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

 // Define variables
 var table_name = 'sys_update_xml',
  encoded_query = 'name=' + engine.current.name + '^update_set.state=in progress^update_set.is_default=false';

 // Count record
 var gaCountRecord = new GlideAggregate(table_name);
 gaCountRecord.addEncodedQuery(encoded_query);
 gaCountRecord.groupBy('name');
 gaCountRecord.addAggregate('COUNT');
 gaCountRecord._query();

 // Create scan finding
 if(gaCountRecord._next() &amp;&amp; gaCountRecord.getAggregate('COUNT') &gt; 1) {
  engine.finding.increment();
 }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Customer Update in progress in multiple Update Sets&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;ffe8e03287ae1150fc79edbe8bbb3551&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Customer Update in progress in multiple Update Sets&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_ffe8e03287ae1150fc79edbe8bbb3551&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-2136562827</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>e96edec2878042507bd12fce8bbb35d8</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac5200000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Customer Update in progress in multiple Update Sets</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>ea4cac76c7ae1150500bf23acd775189</update_guid>
<update_guid_history>ea4cac76c7ae1150500bf23acd775189:-2136562827,b3e8e0322aae1150983df6d5ce022b53:-152181655</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_bbe8e03287ae1150fc79edbe8bbb3567</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;performance&lt;/category&gt;&lt;description&gt;Using getRowCount method of GlideRecord can cause performance issues while quering on tables with high record count. The method counts each row one by one to determine the total row count and hence more the number of rows, more time it would take to execute scripts that uses it.&lt;/description&gt;&lt;documentation_url&gt;https://developer.servicenow.com/dev.do#!/reference/api/rome/server_legacy/c_GlideAggregateAPI&lt;/documentation_url&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Do not use getRowCount() for fetching row count&lt;/name&gt;&lt;priority&gt;3&lt;/priority&gt;&lt;resolution_details&gt;Instead of using getRowCount, use GlideAggregate to retrieve table row count as this will improve performance because it works like a stored procedure.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function(engine) {

    var script = engine.columnValue;
    if (script.indexOf("getRowCount") &gt; -1) {
        engine.finding.increment();
    }

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Do not use getRowCount() for fetching row count&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:20&lt;/sys_created_on&gt;&lt;sys_id&gt;bbe8e03287ae1150fc79edbe8bbb3567&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Do not use getRowCount() for fetching row count&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_bbe8e03287ae1150fc79edbe8bbb3567&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:20&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>2108417624</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>ed6e9ec2878042507bd12fce8bbb35dc</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac45a0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Do not use getRowCount() for fetching row count</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>524c6c76b3ae1150fcb47caf9c2f3cf4</update_guid>
<update_guid_history>524c6c76b3ae1150fcb47caf9c2f3cf4:2108417624,7fe8e0321fae1150e8359ce0117b7768:-901524404</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>scan_check_ebe8e03287ae1150fc79edbe8bbb3548</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_check"&gt;&lt;scan_check action="DELETE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;attributes/&gt;&lt;category&gt;manageability&lt;/category&gt;&lt;description&gt;When flow engine context records are queued, the actual flow has not started yet. (A)synchronous flows should be handled by the flow engine event handler schedule which runs every 2 seconds, so records still queued after 5 minutes would be abnormal behavior.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;Unprocessed Flow engine context&lt;/name&gt;&lt;priority&gt;1&lt;/priority&gt;&lt;resolution_details&gt;Investigate the queued records, is there a huge volume perhaps, or might the Flow Engine Event Handler schedules not be processing.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

    // Add your code here

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Unprocessed Flow engine context&lt;/short_description&gt;&lt;sys_class_name&gt;scan_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;GIYYH&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-10-18 14:33:19&lt;/sys_created_on&gt;&lt;sys_id&gt;ebe8e03287ae1150fc79edbe8bbb3548&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Unprocessed Flow engine context&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_check_ebe8e03287ae1150fc79edbe8bbb3548&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;GIYYH&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-10-18 14:33:19&lt;/sys_updated_on&gt;&lt;/scan_check&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1184473692</payload_hash>
<remote_update_set display_value="Bay - TL - Deployment Pipeline  Suite Config V2">1d6e9ec2878042507bd12fce8bbb35d4</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>EGMCF</sys_created_by>
<sys_created_on>2024-01-31 21:07:34</sys_created_on>
<sys_id>ed6edec2878042507bd12fce8bbb35d7</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>188b53ac4ee0000001</sys_recorded_at>
<sys_updated_by>EGMCF</sys_updated_by>
<sys_updated_on>2024-01-31 21:07:34</sys_updated_on>
<table/>
<target_name>Unprocessed Flow engine context</target_name>
<type>Check</type>
<update_domain>global</update_domain>
<update_guid>ee4cac7671ae1150af7ea2a5f8002676</update_guid>
<update_guid_history>ee4cac7671ae1150af7ea2a5f8002676:-1184473692,afe8e032b9ae1150d948c5769d4e4249:-803423080</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
